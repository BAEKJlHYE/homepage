<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="anonymous.homepage.buld.dao.BuldMapper">
    <!-- 건물 목록 조회 -->
    <select id="selectBuldList" resultType="anonymous.homepage.buld.vo.BuldVO">
        SELECT BULD_NO
             , BULD_NM
             , ZIPCD
             , ADDR
             , DETAIL_ADDR
             , DELNG_TY_SE_CD
             , (SELECT CD_NM FROM CD WHERE CD = DELNG_TY_SE_CD) AS DELNG_TY_SE_NM
             , GTN
             , PRICE
             , CNTRCT_STTUS_SE_CD
             , (SELECT CD_NM FROM CD WHERE CD = CNTRCT_STTUS_SE_CD) AS CNTRCT_STTUS_SE_NM
             , RL_FLOOR
             , TOT_FLOOR
             , DVR_AR
             , DVR_RL_AEA
             , SUPLY_AR
             , SUPLY_RL_AEA
             , COMPET_YEAR
             , NVL(MVN_DE, '협의 후 가능') AS MVN_DE
             , SALE_SE_CD
             , (SELECT CD_NM FROM CD WHERE CD = SALE_SE_CD) AS SALE_SE_NM
             , TEL_NO
             , RECOMEND_SALE_YN
             , EMRGNCY_SALE_YN
             , REGIST_ID
             , REGIST_DT
             , UPDATE_ID
             , UPDATE_DT
             , ATCH_DOC_ID
             , RNTCHRG
             , MANAGECT
             , PREMUM
             , BULD_DC
        FROM BULD
    </select>

     <!-- 건물 등록 -->
     <insert id="insertBuld" parameterType="anonymous.homepage.buld.vo.BuldVO">
          <selectKey keyProperty="buldNo" resultType="String" order="BEFORE">
               SELECT LPAD(NVL(MAX(TO_NUMBER(BULD_NO)), 0) + 1, 6, 0) AS BULD_NO
               FROM BULD
          </selectKey>
          INSERT INTO BULD (
               BULD_NO
               , BULD_NM
               , ZIPCD
               , ADDR
               , DETAIL_ADDR
               , DELNG_TY_SE_CD
               <if test="gtn != null and gtn != ''">
               , GTN
               </if>
               <if test="price != null and price != ''">
               , PRICE
               </if>
               , CNTRCT_STTUS_SE_CD
               <if test="rlFloor != null and rlFloor != ''">
               , RL_FLOOR
               </if>
               <if test="totFloor != null and totFloor != ''">
               , TOT_FLOOR
               </if>
               <if test="dvrAr != null and dvrAr != ''">
               , DVR_AR
               </if>
               <if test="dvrRlAea != null and dvrRlAea != ''">
               , DVR_RL_AEA
               </if>
               <if test="suplyAr != null and suplyAr != ''">
               , SUPLY_AR
               </if>
               <if test="suplyRlAea != null and suplyRlAea != ''">
               , SUPLY_RL_AEA
               </if>
               <if test="competYear != null and competYear != ''">
               , COMPET_YEAR
               </if>
               <if test="mvnDe != null and mvnDe != ''">
               , MVN_DE
               </if>
               , SALE_SE_CD
               , TEL_NO
               <if test="recomendSaleYn != null and recomendSaleYn != ''">
               , RECOMEND_SALE_YN
               </if>
               <if test="emrgncySaleYn != null and emrgncySaleYn != ''">
               , EMRGNCY_SALE_YN
               </if>
               , REGIST_ID
               , REGIST_DT
               , UPDATE_ID
               , UPDATE_DT
               <if test="atchDocId != null and atchDocId != ''">
               , ATCH_DOC_ID
               </if>
               <if test="rntchrg != null and rntchrg != ''">
               , RNTCHRG
               </if>
               <if test="managect != null and managect != ''">
               , MANAGECT
               </if>
               <if test="premum != null and premum != ''">
               , PREMUM
               </if>
               <if test="buldDc != null and buldDc != ''">
               , BULD_DC
               </if>
               , LOGO_TY
          )
          VALUES (
               #{buldNo}
               , #{buldNm}
               , #{zipcd}
               , #{addr}
               , #{detailAddr}
               , #{delngTySeCd}
               <if test="gtn != null and gtn != ''">
               , #{gtn}
               </if>
               <if test="price != null and price != ''">
               , #{price}
               </if>
               , #{cntrctSttusSeCd}
               <if test="rlFloor != null and rlFloor != ''">
               , #{rlFloor}
               </if>
               <if test="totFloor != null and totFloor != ''">
               , #{totFloor}
               </if>
               <if test="dvrAr != null and dvrAr != ''">
               , #{dvrAr}
               </if>
               <if test="dvrRlAea != null and dvrRlAea != ''">
               , #{dvrRlAea}
               </if>
               <if test="suplyAr != null and suplyAr != ''">
               , #{suplyAr}
               </if>
               <if test="suplyRlAea != null and suplyRlAea != ''">
               , #{suplyRlAea}
               </if>
               <if test="competYear != null and competYear != ''">
               , #{competYear}
               </if>
               <if test="mvnDe != null and mvnDe != ''">
               , #{mvnDe}
               </if>
               , #{saleSeCd}
               , #{telNo}
               <if test="recomendSaleYn != null and recomendSaleYn != ''">
               , #{recomendSaleYn}
               </if>
               <if test="emrgncySaleYn != null and emrgncySaleYn != ''">
               , #{emrgncySaleYn}
               </if>
               , #{userId}
               , SYSDATE
               , #{userId}
               , SYSDATE
               <if test="atchDocId != null and atchDocId != ''">
               , #{atchDocId}
               </if>
               <if test="rntchrg != null and rntchrg != ''">
               , #{rntchrg}
               </if>
               <if test="managect != null and managect != ''">
               , #{managect}
               </if>
               <if test="premum != null and premum != ''">
               , #{premum}
               </if>
               <if test="buldDc != null and buldDc != ''">
               , #{buldDc}
               </if>
               , #{logoTy}
          )
     </insert>
</mapper>